\chapter{Description of the software}

This document contains the description of the implementation of the CodeKataBattle platform.

Its purpose is to provide a complete and detailed explanation of the system and its structure to the developers who will work on the project (in our case, the members of other teams and our professors). It is also a useful reference for the developers who will maintain the system in the future.

\section{Links}
In the following list are provided the links to all the documents that are part of the CodeKataBattle project's implementation

\begin{itemize}
    \item \href{https://github.com/pontig/sw-eng-2-PasiniPontiggiaStasi/tree/main/ITD/CodeKataBattle}{Source Code}
    \item {\color{red}{executable ready to be run}}
\end{itemize}

\section{Implemented features}

In the following, we list the features and the requirements that have been implemented in the system.

Since the group that has implemented the system is composed of three people, as the assignment required, we have not implemented the features regarding the ganmification aspects of the system

\subsubsection*{EDU functional requirements}
\renewcommand{\arraystretch}{0.5}
\begin{longtable}[H]{l p{8cm} l p{2cm}}
    \hline
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\
    \textbf{ID}  & \textbf{Description}                                                                                                                                                                                                                                                     & \textbf{Implemented} & \textbf{Notes}                                                                          \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R1}  & The software shall allow the unregistered EDUs to create an account.                                                                                                                                                                                                     & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R2}  & The software shall allow the registered EDUs to log in.                                                                                                                                                                                                                  & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R3}  & The software shall allow the authenticated EDUs to create new tournaments.                                                                                                                                                                                               & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R4}  & The software shall allow an authenticated EDU to permit other authenticated colleagues to create battles in its tournament, those become owners of the tournament as much as who added them.                                                                             & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R5}  & The software shall allow the authenticated EDUs to create coding battles in their tournaments by letting them upload the Code Kata, setting the minimum and maximum number of STUs per group, registration and final submission deadlines, and the score configurations. & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R6}  & The software shall allow the authenticated EDUs to manually evaluate the work done by STUs subscribed to their own Code Kata battle.                                                                                                                                     & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R7}  & The software shall allow the authenticated EDUs to see the sources produced by each team participating in their tournaments.                                                                                                                                             & {\color{green}yes}   & directly visibile on the GitHub repository                                              \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R8}  & The software shall allow the authenticated EDUs to see the personal tournament score of each STU (which is the sum of all battle scores received in that tournament).                                                                                                    & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R9}  & The software shall allow the authenticated EDUs to see a rank that measures how a STU's performance compares to other STUs in the context of that tournament.                                                                                                            & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R10} & The software shall allow the authenticated EDUs to see the list of ongoing and finished tournaments as well as the corresponding tournament rank.                                                                                                                        & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R11} & The software shall allow the authenticated EDUs to see the list of ongoing and finished battles as well as the corresponding battle rank within a tournament.                                                                                                            & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R12} & The software shall allow an authenticated EDU to close a tournament iff it is one of the owners of that tournament.                                                                                                                                                      & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R13} & When the authenticated EDU creates a tournament, the software shall allow it to define gamification badges concerning that specific tournament.                                                                                                                          & No                   & Not requested                                                                           \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R14} & The software shall allow the authenticated EDU to create new badges and define new rules as well as new variables associated with them.                                                                                                                                  & No                   & Not requested                                                                           \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R15} & The software shall allow all authenticated EDUs to visualize the badges created in CKB by other EDUs.                                                                                                                                                                    & No                   & It is a consequence of the badge feature                                                \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\\hline & & & \\
    \textbf{R16} & The software shall allow all authenticated EDUs to visualize STUs' profile where they can see their collected badges, and some personal information.                                                                                                                     & Not quite            & The profile just shows the list of tournaments and battles the student is subscribed to \\
                 &                                                                                                                                                                                                                                                                          &                      &                                                                                         \\
    \hline
    \caption{EDU's requirements}
\end{longtable}

\subsubsection*{STU functional requirements}

\renewcommand{\arraystretch}{0.5}
\begin{longtable}[H]{l p{8cm} l p{2cm}}
    \hline
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\
    \textbf{ID}  & \textbf{Description}                                                                                                                                                                                                  & \textbf{Implemented} & \textbf{Notes}                                                                          \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R17} & The software shall allow the unregistered STUs to create an account.                                                                                                                                                  & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R18} & The software shall allow the registered STUs to log in.                                                                                                                                                               & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R19} & The software shall allow the authenticated STUs to form teams by inviting other STUs respecting the minimum and maximum number of STUs per group set for that battle.                                                 & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R20} & The software shall allow the authenticated STUs to join a team by an invite.                                                                                                                                          & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R21} & The software shall allow the authenticated STUs to subscribe to a tournament until a certain deadline.                                                                                                                & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R22} & The software shall allow the authenticated STUs subscribed to a coding battle to upload their work until the final submission deadline of that Code Kata battle.                                                      & {\color{green}yes}   & The GitHub pull gets ignored                                                            \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R23} & When the registration deadline of a battle expires, the software shall create a GitHub repository containing the Code Kata.                                                                                           & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R24} & The software shall send to all authenticated STUs who are members of subscribed teams to a battle the link to a GitHub repository containing the Code Kata.                                                           & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R25} & The software shall run the tests on executables pushed by a team, it shall also calculate and update the battle score of the corresponding team.                                                                      & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R26} & At the end of the consolidation stage of a specific battle \textit{'b'}, the software shall send a notification to all authenticated STUs participating to \textit{'b'} when the final battle rank becomes available. & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R27} & The software shall allow the authenticated STUs to see the list of ongoing and finished battles as well as the corresponding battle rank, iff they are part of the tournament.                                        & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R28} & The software shall allow all authenticated STUs to see the personal tournament score of each STU (which is the sum of all battle scores received in that tournament).                                                 & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R29} & The software shall allow all authenticated STUs to see a rank that measures how a STU's performance compares to other STUs in the context of that tournament.                                                         & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R30} & The software shall allow all authenticated STUs to see the list of ongoing and finished tournaments as well as the corresponding tournament rank.                                                                     & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R31} & The software shall notify all authenticated STUs involved in a closed tournament when the final tournament rank becomes available.                                                                                    & {\color{green}yes}   &                                                                                         \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\\hline & & & \\
    \textbf{R32} & The software shall allow all authenticated STUs to visualize other STUs' profile where they can see their collected badges, and some personal information.                                                            & Not quite            & The profile just shows the list of tournaments and battles the student is subscribed to \\
                 &                                                                                                                                                                                                                       &                      &                                                                                         \\
    \hline
    \caption{STU's requirements}
\end{longtable}

\section{Adopted development framework}

For a thorough exposition of the pros and cons associated with the languages in question, it is recommendend to search directly on the official websites of said languages, where such aspects are explicated in detail

\subsubsection{Backend}
The system has been developed using the \textbf{Spring Boot} framework, which is a framework that allows to create web applications in Java.\\
The main reason for this choice is that it is a framework often used in this context since it allows to create a web application with REST APIs in a simple way.\\In addiction, there are a lot of libraries that can be used to integrate the framework with other technologies, such as the database, which is very useful.\\

In order to perform the static analysis of the code, we have used \textbf{SonarQube}, which is a tool that allows to perform a static analysis of the code and to find the bugs and the vulnerabilities.

\subsubsection{Frontend}
For the development of the frontend, we have implemented a single page application simply using \textbf{HTML, SCSS and JavaScript}.\\Even it is a dated approach, we have chosen this solution because it is the one that we are most familiar with and because it is the one that we have used in the previous projects.\\Moreover, since the application is very simple, we have not felt the need to use a more complex framework.

\subsubsection{Database}
The database has been implemented using \textbf{MySQL}.\\
The main reason for this choice is that it is the most used database in the world and it can be easily integrated with the Spring Boot framework thanks to the \textbf{Spring Data JPA} library.

\section{Structure of the source code}

The source code of the system can be found in the \href{https://github.com/pontig/sw-eng-2-PasiniPontiggiaStasi/tree/main/ITD/CodeKataBattle}{ITD folder} of the repository.\\
Its structure is the classical one of a Spring Boot application, which is the following:
\begin{itemize}
    \item {\ttfamily{src/main/java/ckb/platform/}}: contains the source code of the spring application, divided in the following subfolders:
          \begin{itemize}
              \item {\ttfamily{advices/}}: contains the classes that are used to insert into the response the error messages in case of exceptions
              \item {\ttfamily{controllers/}}: contains the classes that are used to handle the requests and are the responsible of the communication between the APIs and the database
              \item {\ttfamily{entities/}}: contains the JPA classes that represent the entities of the database
              \item {\ttfamily{exceptions/}}: contains the classes that are used to handle the exceptions
              \item {\ttfamily{formParser/}}: contains the java beans that are used to parse the forms of the POST requests
              \item {\ttfamily{githubAPI/}}: contains the class that is used to communicate with the GitHub API
              \item {\ttfamily{repositories/}}: contains the interfaces that are used to communicate with the database
              \item {\ttfamily{scheduler/}}: contains the classes that handle the additional threads that keeps the time updated and, whenever a deadline is reached, that send the emails to the interested users
              \item {\ttfamily{testRepo/}} contains the class that is the responsible of the building of the code and the execution of the tests
          \end{itemize}
    \item {\ttfamily{src/main/resources/static/}}: contains the files of the frontend application, i.e. the HTML, SCSS and JavaScript files
\end{itemize}

\chapter{Performed test}

The software testing procedure has been performed mainly thorough unit testing; below are listed the most relevant tests that have been performed.\\
Due to the limited time, we have focused on the backend system, since the frontend is very simple and the majority of the functionalities are implemented in the backend.


\section{Tournament}

\begin{enumerate}
    \item an EDU creates a tournament, with a new name or a name that already exists
    \item a STU subscribes to a tournament
    \item an EDU closes a tournament
\end{enumerate}

\section{GitHub / Static Analysis / mail sending}

\begin{enumerate}
    \item the system sends an email to the right users when a deadline is reached or a significant event happens
    \item the system creates a GitHub repository at the end of the registration phase of a battle
    \item after a push, the system gets notified by GitHub, retrieves the code in the form of a zip file, unzips it, runs the tests and updates the score

\section{Battle}

\begin{enumerate}
    \item an EDU creates a battle, selecting one or more options regarding static analysis and manual evaluation
    \item a STU subscribes to a battle, both alone and inviting other STUs
    \item a STU invites another STU to a battle after being subscribed
    \item a STU joins a battle by an invite
    \item a STU uploads the code on GitHub and sees his score updated, taking into account the tests, the timeliness and the eventual static analysis
    \item an EDU performs the manual evaluation of the code of the teams in a battle
\end{enumerate}

\section{Profile}

\begin{enumerate}
    \item an user inspects the profile of a STU's profile showing the list of tournaments and battles the student is subscribed to
\end{enumerate}

\chapter{Installation instructions}
\section{Static Analysis Tool - SonarQube}
In order to use this tool, we need to install SonarQube Community Edition at this \href[]{https://www.sonarqube.org/downloads/}{link}.\\
The next step is to install a local instance of SonarQube by following these \href[]{https://docs.sonarsource.com/sonarqube/latest/try-out-sonarqube/#installing-a-local-instance-of-sonarqube}{instructions}.\\
In our case we simply run from the zip file, using Windows as a OS and we have installed it in the same directory of the instructions.\\
\textbf{If you are installing it in a different location, you have to insert the correct directory when the application starts}.\\
\textbf{Java 17 is required to start the local instance of SonarQube}.\\
Now we need to install the SonarScanner for CLI and we can find the download \href[]{https://docs.sonarsource.com/sonarqube/latest/analyzing-source-code/scanners/sonarscanner/}{here}.\\